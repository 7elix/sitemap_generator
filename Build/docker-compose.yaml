version: '3'
services:
  app:
    build:
      context: .
      dockerfile: Dockerfile.development
    volumes:
      - './docker/:/docker'
      - './../:/app/'
    hostname: ${VIRTUAL_HOST}
    ipc: host
    privileged: true
    environment:
      VIRTUAL_HOST: .${VIRTUAL_HOST}
      VIRTUAL_PORT: 80
      TYPO3_CONTEXT: ${TYPO3_CONTEXT}
    env_file:
      - etc/environment.yml
      - etc/environment.development.yml
    restart: always
    depends_on:
      - mysql
    networks:
      default:
        aliases:
          - ${VIRTUAL_HOST}

  mysql:
    build:
      context: docker/mysql/
      dockerfile: MariaDB-10.Dockerfile
    #ports:
    #  - 13306:3306
    volumes:
      - mysql:/var/lib/mysql
    env_file:
      - etc/environment.yml
      - etc/environment.development.yml
  mail:
    image: mailhog/mailhog
    ports:
      - '8025:8025'

volumes:
  mysql:
